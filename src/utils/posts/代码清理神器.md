# Knip - ä¸€é”®æ¸…ç†é¡¹ç›®æ— ç”¨ä»£ç 

## ç®€ä»‹

åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéšç€æ—¶é—´æ¨ç§»ï¼Œä»£ç åº“ä¸­éš¾å…ä¼šç§¯ç´¯ä¸€äº›ä¸å†ä½¿ç”¨çš„æ–‡ä»¶ã€å‡½æ•°ã€å˜é‡ç­‰"æ­»ä»£ç "ã€‚è¿™äº›æ— ç”¨ä»£ç ä¸ä»…ä¼šå¢åŠ ä»£ç åº“çš„å¤æ‚åº¦ï¼Œè¿˜å¯èƒ½å¯¼è‡´ç»´æŠ¤å›°éš¾ã€‚**Knip** æ˜¯ä¸€ä¸ªå¼ºå¤§çš„é™æ€ä»£ç åˆ†æå·¥å…·ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹å¹¶å¸®åŠ©ä½ æ¸…ç† JavaScript å’Œ TypeScript é¡¹ç›®ä¸­çš„æ— ç”¨ä»£ç ã€‚

## Knip çš„æ ¸å¿ƒä½œç”¨

### 1. **æ£€æµ‹æœªä½¿ç”¨çš„æ–‡ä»¶**
è¯†åˆ«é¡¹ç›®ä¸­æ²¡æœ‰è¢«ä»»ä½•åœ°æ–¹å¯¼å…¥çš„æ–‡ä»¶ã€‚

### 2. **å‘ç°æœªä½¿ç”¨çš„å¯¼å‡º**
æ‰¾å‡ºå®šä¹‰åœ¨æ–‡ä»¶ä¸­ä½†ä»æœªè¢«ä½¿ç”¨çš„å‡½æ•°ã€ç±»ã€å˜é‡ç­‰ã€‚

### 3. **æ£€æµ‹æœªä½¿ç”¨çš„ä¾èµ–**
è¯†åˆ« `package.json` ä¸­å·²å®‰è£…ä½†æœªåœ¨ä»£ç ä¸­ä½¿ç”¨çš„ä¾èµ–åŒ…ã€‚

### 4. **åˆ†æé¡¹ç›®ç»“æ„**
æ·±å…¥åˆ†æä»£ç ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç²¾ç¡®å®šä½æ­»ä»£ç ã€‚

### 5. **æ”¯æŒå¤šç§æ¡†æ¶**
æ”¯æŒ Vueã€Reactã€Next.jsã€Nuxtã€TypeScriptã€ESMã€CommonJS ç­‰å¤šç§é¡¹ç›®ç±»å‹ã€‚

## å®‰è£…å’Œé…ç½®

### å…¨å±€å®‰è£…

```bash
npm install -g knip
# æˆ–
yarn global add knip
# æˆ–
pnpm add -g knip
```

### é¡¹ç›®çº§å®‰è£…ï¼ˆæ¨èï¼‰

```bash
npm install --save-dev knip
# æˆ–
yarn add --dev knip
# æˆ–
pnpm add -D knip
```

### åŸºç¡€é…ç½®

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `knip.json` é…ç½®æ–‡ä»¶ï¼š

```json
{
  "entry": ["src/main.js"],
  "project": ["src/**/*.{js,vue,ts,tsx}"],
  "ignore": ["**/*.spec.ts", "**/*.test.ts", "src/types/**"]
}
```

## å¸¸ç”¨å‘½ä»¤

### æ£€æŸ¥é¡¹ç›®

```bash
npx knip
```

è¿™ä¼šè¾“å‡ºæ‰€æœ‰æ‰¾åˆ°çš„æœªä½¿ç”¨çš„æ–‡ä»¶ã€å¯¼å‡ºå’Œä¾èµ–ã€‚

### ä¿®å¤æœªä½¿ç”¨çš„æ–‡ä»¶

```bash
npx knip --fix
# æˆ–åˆ é™¤
npx knip --fix --delete
```

### ç”ŸæˆæŠ¥å‘Š

```bash
npx knip --reporter json > report.json
npx knip --reporter csv > report.csv
npx knip --reporter sarif > report.sarif
```

### ä¸¥æ ¼æ¨¡å¼

```bash
npx knip --strict
```

æ­¤æ¨¡å¼ä¸‹ï¼Œä»»ä½•é—®é¢˜éƒ½ä¼šå¯¼è‡´å‘½ä»¤å¤±è´¥ï¼ˆéé›¶é€€å‡ºç ï¼‰ï¼Œé€‚åˆ CI/CD æµç¨‹ã€‚

## å®æˆ˜ç¤ºä¾‹

å‡è®¾ä½ æœ‰ä¸€ä¸ª Vue 3 é¡¹ç›®çš„ç»“æ„å¦‚ä¸‹ï¼š

```
src/
â”œâ”€â”€ main.js
â”œâ”€â”€ App.vue
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Header.vue
â”‚   â”œâ”€â”€ Footer.vue
â”‚   â””â”€â”€ OldComponent.vue  (å·²å¼ƒç”¨ä½†æœªåˆ é™¤)
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ helpers.js
â”‚   â””â”€â”€ deprecated.js  (æœªè¢«ä½¿ç”¨)
â””â”€â”€ router/
    â””â”€â”€ index.js
```

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
npx knip
```

å¯èƒ½ä¼šè¾“å‡ºï¼š

```
Unused files (2):
  src/components/OldComponent.vue
  src/utils/deprecated.js

Unused exports (3):
  src/utils/helpers.js: unusedHelper()
  src/router/index.js: oldRoute
```

ç„¶åä½ å¯ä»¥æ‰‹åŠ¨å®¡æŸ¥è¿™äº›æ–‡ä»¶ï¼Œç¡®è®¤ååˆ é™¤å®ƒä»¬ï¼š

```bash
npx knip --fix
```

## Vue 3 é¡¹ç›®ç‰¹æ®Šé…ç½®

å¯¹äº Vue 3 é¡¹ç›®ï¼Œæ¨èçš„ `knip.json` é…ç½®ï¼š

```json
{
  "entry": ["src/main.js"],
  "project": ["src/**/*.{js,vue,ts,tsx}"],
  "ignore": ["src/types/**", "**/*.spec.ts"],
  "tsConfigPath": "tsconfig.json"
}
```

## ä¸ package.json é›†æˆ

åœ¨ `package.json` ä¸­æ·»åŠ è„šæœ¬ï¼š

```json
{
  "scripts": {
    "lint": "eslint src",
    "check-unused": "knip",
    "check-unused:fix": "knip --fix",
    "check-unused:strict": "knip --strict"
  }
}
```

## æœ€ä½³å®è·µ

### 1. **å®šæœŸè¿è¡Œ**
åœ¨ CI/CD æµç¨‹ä¸­é›†æˆ Knipï¼Œå®šæœŸæ£€æŸ¥æœªä½¿ç”¨çš„ä»£ç ï¼š

```yaml
# GitHub Actions ç¤ºä¾‹
name: Code Quality
on: [push, pull_request]
jobs:
  knip:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm install
      - run: npx knip --strict
```

### 2. **åˆ†é˜¶æ®µæ¸…ç†**
ä¸è¦ä¸€æ¬¡æ€§æ¸…ç†æ‰€æœ‰ä»£ç ï¼Œåˆ†é˜¶æ®µè¿›è¡Œï¼š
- å…ˆç”ŸæˆæŠ¥å‘Šï¼Œäººå·¥å®¡æŸ¥
- ç¡®è®¤æ— è¯¯åå†åˆ é™¤
- æäº¤åˆ° Git åè¿›è¡Œæµ‹è¯•

### 3. **æ·»åŠ å¿½ç•¥è§„åˆ™**
æŸäº›æ–‡ä»¶å¯èƒ½çœ‹èµ·æ¥æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œä½†å®é™…ä¸Šæ˜¯é€šè¿‡åŠ¨æ€å¯¼å…¥æˆ–å…¶ä»–æ–¹å¼å¼•ç”¨çš„ï¼Œéœ€è¦åœ¨é…ç½®ä¸­å¿½ç•¥ï¼š

```json
{
  "ignore": ["src/plugins/**", "src/directives/**"]
}
```

### 4. **å…³æ³¨å¯¼å‡ºè€Œéæ–‡ä»¶**
æœ‰æ—¶ä¸€ä¸ªæ–‡ä»¶ä¸­æœ‰å¤šä¸ªå¯¼å‡ºï¼Œåªæœ‰éƒ¨åˆ†è¢«ä½¿ç”¨ï¼ŒKnip èƒ½ç²¾ç¡®è¯†åˆ«æœªä½¿ç”¨çš„å¯¼å‡ºï¼Œå¸®åŠ©ä½ åªåˆ é™¤éœ€è¦çš„éƒ¨åˆ†ã€‚

## å¯¹æ¯”å…¶ä»–å·¥å…·

| å·¥å…· | Knip | ESLint | Depcheck |
|------|------|--------|----------|
| æ£€æµ‹æœªä½¿ç”¨æ–‡ä»¶ | âœ… | âŒ | âœ… |
| æ£€æµ‹æœªä½¿ç”¨å¯¼å‡º | âœ… | âš ï¸ (æ’ä»¶) | âŒ |
| æ£€æµ‹æœªä½¿ç”¨ä¾èµ– | âœ… | âŒ | âœ… |
| è‡ªåŠ¨ä¿®å¤ | âœ… | âœ… | âŒ |
| æ€§èƒ½ | å¿«é€Ÿ | å¿«é€Ÿ | ä¸€èˆ¬ |

## æ³¨æ„äº‹é¡¹

âš ï¸ **ä½¿ç”¨å‰å¤‡ä»½**ï¼šåœ¨ä½¿ç”¨ `--fix --delete` å‰ï¼Œç¡®ä¿ä½ çš„ä»£ç å·²æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚

âš ï¸ **äººå·¥å®¡æŸ¥**ï¼šä¸è¦ç›²ç›®åˆ é™¤æ‰€æœ‰æŠ¥å‘Šçš„ä»£ç ï¼ŒæŸäº›åŠ¨æ€å¯¼å…¥ã€ç‰¹æ®Šæ¡†æ¶ç‰¹æ€§å¯èƒ½è¢«è¯¯è®¤ä¸ºæ˜¯æ— ç”¨ä»£ç ã€‚

âš ï¸ **é…ç½®ç²¾ç¡®æ€§**ï¼šç¡®ä¿ `entry` å’Œ `project` é…ç½®å‡†ç¡®ï¼Œå¦åˆ™å¯èƒ½è¯¯æŠ¥å¤§é‡çš„"æœªä½¿ç”¨ä»£ç "ã€‚

## æ€»ç»“

Knip æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„ä»£ç æ¸…ç†å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ ï¼š
- ğŸ§¹ è‡ªåŠ¨è¯†åˆ«å’Œæ¸…ç†æ— ç”¨ä»£ç 
- ğŸ“Š ç”Ÿæˆè¯¦ç»†çš„ä»£ç ä½¿ç”¨æŠ¥å‘Š
- ğŸ”„ é›†æˆåˆ° CI/CD æµç¨‹ä¸­è‡ªåŠ¨åŒ–æ£€æŸ¥
- ğŸ¯ æ”¹è¿›ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§

é€šè¿‡å®šæœŸä½¿ç”¨ Knipï¼Œä½ å¯ä»¥ä¿æŒä»£ç åº“çš„æ•´æ´ï¼Œæé«˜é¡¹ç›®çš„å¯ç»´æŠ¤æ€§å’Œå›¢é˜Ÿçš„å¼€å‘æ•ˆç‡ã€‚

## ç›¸å…³èµ„æº

- [Knip å®˜ç½‘](https://knip.dev)
- [GitHub ä»“åº“](https://github.com/webpro/knip)
- [æ–‡æ¡£](https://knip.dev/docs/getting-started)

---

*æœ€åæ›´æ–°ï¼š2026 å¹´ 1 æœˆ*